---
layout: post
title: linux下模拟Xshell/Scrt的自动登录多台服务器操作命令以及对linux终端的位置控制
categories:
- expect
- linux基础
tags:
- cssh
- linux组服务器操作
- linux终端命令
- 移动linux终端
published: true
comments: true
indexer: true
---
<p>前言：windows下的终端登录软件xshell或者Scrt都有自动登录以及做组操作的功能，linux下好像cssh也能作类似的东西，我闲来体验了linux下类似的操作，简单的原理是expect+gnome终端：</p>

<p>请看我的主脚本：主要实现的是将testex脚本的SSH登录服务器ip修改，然后启动新终端，再执行expect脚本里面的内容，启动一个python脚本</p>

<p><pre class="sh_python">
dongwm@linux-b8lh:~&gt; cat term
import time
import os
cip = '192.168.1.6'
i = 0
list = ［'192.168.1.1','192.168.1.2','192.168.1.3','192.168.1.4','192.168.1.5','192.168.1.6'］
for ip in list:
    os.system('sed -i "s/%s/%s/" ~/testex' % (cip,ip))
    if i &lt;3:                     #这里的move其实就是终端在屏幕上的偏移量，我的屏幕分辨率是1440＊900,根据这个不同下面的值也不同，我设计的是桌面铺满6个，一行三个
        num = 480*i
        move = '58x20+%s+0' % num
    else:
        num = 480*(i-4)
        move = '58x20+%s+400' % num
    cmd = 'gnome-terminal --geometry=%s -e ~/testex' % move   #--geometry选项是窗体的长＊窗体的宽+左右偏移+上下偏移, opensuse默认的效果是80x24+200+200
    os.system(cmd)
    cip = ip
    print '%s done' % ip
    i +=1
    time.sleep(0.1)
</pre>
#这是一个expect脚本，语法参看我以前的文章：<a href="http://www.dongwm.com/archives/%e5%85%b3%e4%ba%8eexpect%e7%a0%94%e7%a9%b6%ef%bc%88%e4%ba%8c%ef%bc%89/" target="_blank">关于expect研究（二）</a>
<pre class="sh_tcl">
dongwm@linux-b8lh:~&gt; cat testex    
#!/usr/bin/expect
set timeout 10
set password 34wsetg6\(\#
spawn luit -encoding gbk ssh -p 61002 root@192.168.1.6
expect "#"
send "python /home/dongwm/RevSocket.py\n"
interact
</pre></p>
