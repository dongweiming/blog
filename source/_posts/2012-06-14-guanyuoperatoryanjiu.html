---
layout: post
title: 关于operator研究
categories:
- python模块研究
tags:
- operator
published: true
comments: true
indexer: true
---
<p>前言：operator是一系列内置的运算接口</p>

<p><pre class="sh_python">
from operator import *</p>

<p>a = -1
b = 5.0
c = 2
d = 6
print 'a =', a
print 'b =', b
print 'c =', c
print 'd =', d
print '-'*30</p>

<p>print 'not_(a)     :', not_(a) #逻辑判断是不是一个数据
print 'truth(a)    :', truth(a) 逻辑判断数据是不是为真
print 'is_(a, b)   :', is_(a,b) #逻辑判断a是b的bool结果
print 'is_not(a, b):', is_not(a,b) #逻辑判断a不是b的bool结果
for func in (lt, le, eq, ne, ge, gt):  
    print '%s(a, b):' % func.__name__, func(a, b)  #判断大小和相等
print '\nPositive/Negative:' 
print 'abs(a):', abs(a) #a绝对值
print 'neg(a):', neg(a) #a的补数</p>

<p>print '\nArithmetic:'
print 'add(a, b)     :', add(a, b)  #求和
print 'div(a, b)     :', div(a, b) #a/b结果
print 'div(d, c)     :', div(d, c) 
print 'floordiv(a, b):', floordiv(a, b) #地板除
print 'floordiv(d, c):', floordiv(d, c)
print 'mod(a, b)     :', mod(a, b) #
print 'mul(a, b)     :', mul(a, b)
print 'pow(c, d)     :', pow(c, d)
print 'sub(b, a)     :', sub(b, a)
print 'truediv(a, b) :', truediv(a, b)
print 'truediv(d, c) :', truediv(d, c)</p>

<p>print '\nBitwise:'
print 'and_(c, d)  :', and_(c, d) 
print 'invert(c)   :', invert(c)
print 'lshift(c, d):', lshift(c, d)
print 'or_(c, d)   :', or_(c, d)
print 'rshift(d, c):', rshift(d, c)
print 'xor(c, d)   :', xor(c, d)</p>

<p>a = [ 1, 2, 3 ]
b = [ 'a', 'b', 'c' ]
print 'a =', a
print 'b =', b</p>

<p>print '\nConstructive:'
print '  concat(a, b):', concat(a, b)  #序列叠加
print '  repeat(a, 3):', repeat(a, 3)  #序列重复3次</p>

<p>print '\nSearching:'
print '  contains(a, 1)  :', contains(a, 1)  #寻找是否a中包含1，返回bool
print '  contains(b, "d"):', contains(b, "d") #寻找是否b中包字母‘d’，返回bool
print '  countOf(a, 1)   :', countOf(a, 1) #返回符合值的数量
print '  countOf(b, "d") :', countOf(b, "d")
print '  indexOf(a, 5)   :', indexOf(a, 1) #返回符合的索引值</p>

<p>print '\nAccess Items:'
print '  getitem(b, 1)            :', getitem(b, 1) #返回b的第2項
print '  getslice(a, 1, 3)        :', getslice(a, 1, 3)#返回序列a的第2－3项
print '  setitem(b, 1, "d")       :', setitem(b, 1, "d"), ', after b =', b #设置b的第二项是‘d’，替换原来的
print '  setslice(a, 1, 3, [4, 5]):', setslice(a, 1, 3, [4, 5]), ', after a =', a </p>

<p>print '\nDestructive:'
print '  delitem(b, 1)    :', delitem(b, 1), ', after b =', b #去掉序列b的第2项
print '  delslice(a, 1, 3):', delslice(a, 1, 3), ', after a =', a #去掉序列a的第2－3项</p>

<p>a = -1
b = 5.0
c = [ 1, 2, 3 ]
d = [ 'a', 'b', 'c']
print 'a =', a
print 'b =', b
print 'c =', c
print 'd =', d
print</p>

<p>a = iadd(a, b)
print 'a = iadd(a, b) =&gt;', a  #类似于a+=b a变化了
print</p>

<p>c = iconcat(c, d)
print 'c = iconcat(c, d) =&gt;', c #类似于c+=d c变化了
</pre></p>

<p>&nbsp;</p>

<p>执行结果：</p>

<p>dongwm@linux-dongwm:~&gt; python test.py
a = -1
b = 5.0
c = 2
d = 6
------------------------------
not_(a)     : False
truth(a)    : True
is_(a, b)   : False
is_not(a, b): True
lt(a, b): True
le(a, b): True
eq(a, b): False
ne(a, b): True
ge(a, b): False
gt(a, b): False</p>

<p>Positive/Negative:
abs(a): 1
neg(a): 1
neg(b): -5.0
pos(a): -1
pos(b): 5.0</p>

<p>Arithmetic:
add(a, b)     : 4.0
div(a, b)     : -0.2
div(d, c)     : 3
floordiv(a, b): -1.0
floordiv(d, c): 3
mod(a, b)     : 4.0
mul(a, b)     : -5.0
pow(c, d)     : 64
sub(b, a)     : 6.0
truediv(a, b) : -0.2
truediv(d, c) : 3.0</p>

<p>Bitwise:
and_(c, d)  : 2
invert(c)   : -3
lshift(c, d): 128
or_(c, d)   : 6
rshift(d, c): 1
xor(c, d)   : 4
a = [1, 2, 3]
b = ['a', 'b', 'c']</p>

<p>Constructive:
concat(a, b): [1, 2, 3, 'a', 'b', 'c']
repeat(a, 3): [1, 2, 3, 1, 2, 3, 1, 2, 3]</p>

<p>Searching:
contains(a, 1)  : True
contains(b, "d"): False
countOf(a, 1)   : 1
countOf(b, "d") : 0
indexOf(a, 5)   : 0</p>

<p>Access Items:
getitem(b, 1)            : b
getslice(a, 1, 3)        : [2, 3]
setitem(b, 1, "d")       : None , after b = ['a', 'd', 'c']
setslice(a, 1, 3, [4, 5]): None , after a = [1, 4, 5]</p>

<p>Destructive:
delitem(b, 1)    : None , after b = ['a', 'c']
delslice(a, 1, 3): None , after a = [1]
a = -1
b = 5.0
c = [1, 2, 3]
d = ['a', 'b', 'c']</p>

<p>a = iadd(a, b) =&gt; 4.0</p>

<p>c = iconcat(c, d) =&gt; [1, 2, 3, 'a', 'b', 'c']</p>

<p>&nbsp;</p>

<p><pre class="sh_prolog">
from operator import *</p>

<p>class MyObj(object):
    """example class for attrgetter"""
    def __init__(self, arg):
        super(MyObj, self).__init__()
        self.arg = arg
    def __repr__(self):
        return 'MyObj(%s)' % self.arg  #设置出发一个属性的修改，添加了arg这个属性</p>

<p>l = [ MyObj(i) for i in xrange(5) ]
print l
g = attrgetter('arg')  #获取属性arg
vals = [ g(i) for i in l ]
print vals
</pre></p>

<p>&nbsp;</p>

<p><pre class="sh_python">
from operator import *</p>

<p>print 'Dictionaries:'
l = [ dict(val=i) for i in xrange(5) ]  #这个的意义就是匿名函数：<tt>lambda x, y=5: x[y]</tt>
print l
g = itemgetter('val')
vals = [ g(i) for i in l ]
print vals</p>

<p>print
print 'Tuples:'
l = [ (i, i*2) for i in xrange(5) ]
print l
g = itemgetter(1)
vals = [ g(i) for i in l ]
print vals
</pre>
<pre class="sh_python">
from operator import *</p>

<p>class MyObj(object):
    def __init__(self, val):
        super(MyObj, self).__init__()
        self.val = val
        return
    def __str__(self):
        return 'MyObj(%s)' % self.val
    def __lt__(self, other):  #自定义了比较lt的方法
        print 'Testing %s &lt; %s' % (self, other)
        return self.val &lt; other.val
    def __add__(self, other): #自定义了add的方法
        print 'Adding %s + %s' % (self, other)
        return MyObj(self.val + other.val)</p>

<p>a = MyObj(1)
b = MyObj(2)</p>

<p>print 'Comparison:'
print lt(a, b)</p>

<p>print '\nArithmetic:'
print add(a, b)
</pre></p>

<p>&nbsp;</p>

<p>执行结果：</p>

<p>dongwm@linux-dongwm:~&gt; python test.py
Comparison:
Testing MyObj(1) &lt; MyObj(2)   #触发了a的__lt__
True
Arithmetic:
Adding MyObj(1) + MyObj(2) #触发了a的__add__
MyObj(3)</p>
